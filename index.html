<!doctype html> 
<html lang="en"> 
<head> 
	<meta charset="UTF-8" />
	<title> Be The Change</title>
	<script src="//cdn.jsdelivr.net/npm/phaser@3.11.0/dist/phaser.js"></script>
	<style type="text/css">
		body {
			margin: 0;
		}
	</style>
</head>
<body>

<script type="text/javascript">

	var config = {
		type: Phaser.AUTO,
		width: 2000,
		height: 2000,
		physics: {
			default: 'arcade',
			arcade: {
				debug: false 
			}
		},
		scene: {
			preload: preload,
			create: create,
			update: update
		}
	};

	var player;
	var bad_ground;
	var bad_building;
	var cursors;
	var game = new Phaser.Game(config);

	function preload ()
	{
		this.load.image('bad_ground', 'assets/bad_ground.jpg');
		this.load.image("bad_building", "assets/bad_building.png");
		this.load.image("bad_building2", "assets/bad_building2.png");
		this.load.image("bad_home", "assets/bad_home.png");
		this.load.image("bad_park", "assets/bad_park.png");
		this.load.image("bad_pool", "assets/bad_pool.png");
		this.load.image("bad_tree", "assets/bad_tree.png");
		this.load.spritesheet('dude', 'assets/spr_fembase_walk_strip16.png', { frameWidth: 32, 
			frameHeight: 64});
	}

	function create ()
	{
		bad_ground = this.physics.add.staticGroup();
		bad_ground.create(1000, 1000, 'bad_ground');
		
		player = this.physics.add.sprite(1000, 800, 'dude');
		this.cameras.main.x = -500;
		this.cameras.main.y = -500;

		player.setBounce(0.2);
		player.setCollideWorldBounds(true);

		this.anims.create({
			key: 'left',
			frames: this.anims.generateFrameNumbers('dude', { start: 8, end: 11 }),
			frameRate: 10,
			repeat: -1
		});

		this.anims.create({
			key: 'turn',
			frames: [ { key: 'dude', frame: 4 } ],
			frameRate: 20
		});

		this.anims.create({
			key: 'right',
			frames: this.anims.generateFrameNumbers('dude', { start: 0, end: 3 }),
			frameRate: 10,
			repeat: -1
		});

		this.anims.create({
			key: 'up',
			frames: this.anims.generateFrameNumbers('dude', { start: 4, end: 7 }),
			frameRate: 10,
			repeat: -1
		});

		this.anims.create({
			key: 'down',
			frames: this.anims.generateFrameNumbers('dude', { start: 4, end: 7 }),
			frameRate: 10,
			repeat: -1
		});

		bad_building = this.physics.add.staticGroup({
        	key: 'bad_building',
        	repeat: 11,
        	setXY: { x: 1200, y: 1000, stepX: 200 , stepY: 200}
    	});

    	// bad_building.children.iterate(function (child) {
     //   		c
    	// });

		cursors = this.input.keyboard.createCursorKeys();
		
		this.physics.add.collider(player, bad_building);
		this.cameras.main.startFollow(player);
	}
	var speed = 250;
	function update ()
	{
		if (cursors.right.isDown)
		{	
            player.setVelocityX(speed);
			player.setVelocityY(0);
			player.anims.play('right', true);
		}
		else if(cursors.left.isDown)
		{
			player.setVelocityX(-speed);
			player.setVelocityY(0);
			player.anims.play('left', true);
		}
		else if(cursors.up.isDown)
		{
            player.setVelocityY(-speed);
			player.setVelocityX(0);
			player.anims.play('up', true);
		}
		else if(cursors.down.isDown)
		{
            player.setVelocityY(speed);
			player.setVelocityX(0);
			player.anims.play('down', true);	
		}
		else
		{
			player.setVelocityX(0);
			player.setVelocityY(0);
			player.anims.play('turn');
		}
	}

</script>

</body>
</html>